<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function reference â€¢ RGCA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function reference"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RGCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/RGCA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Simple_RGCA.html">Simple Application of RGCA</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Spatiotemporal-Exposures-and-Toxicology/RGCA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-index">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Function reference</h1>
    </div>

    <div class="section level2">
      <h2 id="rgca-mcmc-functions">RGCA MCMC functions<a class="anchor" aria-label="anchor" href="#rgca-mcmc-functions"></a></h2>
      
      <p class="section-desc"></p><p>Functions related to MCMC parameter estimation</p>

      
    </div><div id="" class="section level2">
      
      
      

      <dl><dt>
          
          <code><a href="DP_MCMC_fit.html">DP_MCMC_fit()</a></code> 
        </dt>
        <dd>Dirichlet Process MCMC</dd>
      </dl><dl><dt>
          
          <code><a href="RE_MCMC_fit.html">RE_MCMC_fit()</a></code> 
        </dt>
        <dd>Random Effect MCMC fitting</dd>
      </dl><dl><dt>
          
          <code><a href="pull_parameters.html">pull_parameters()</a></code> 
        </dt>
        <dd>Given an MCMC chain fit by RE_MCMC_fit, pull out the chains representing the
parameter posteriors and compute some estimates of the parameters by applying
the summary statistic function to the posterior samples.</dd>
      </dl><dl><dt>
          
          <code><a href="pull_summary_parameters.html">pull_summary_parameters()</a></code> 
        </dt>
        <dd>Given an MCMC chain fit by RE_MCMC_fit, estimate the parameter values using a
summary statistic applied to the posterior samples.</dd>
      </dl><dl><dt>
          
          <code><a href="run_RE_nimble.html">run_RE_nimble()</a></code> 
        </dt>
        <dd>Fit a random effect dose response model using Nimble for fast MCMC.  Nimble
creates a compiled sampler that can run iterations much faster than the
manually implemented version.</dd>
      </dl></div><div class="section level2">
      <h2 id="rgca-plotting-functions">RGCA Plotting functions<a class="anchor" aria-label="anchor" href="#rgca-plotting-functions"></a></h2>
      
      <p class="section-desc"></p><p>Functions to create plots from the manuscript</p>

      
    </div><div id="" class="section level2">
      
      
      

      <dl><dt>
          
          <code><a href="make_ggplot.html">make_ggplot()</a></code> 
        </dt>
        <dd>Makes a ggplot of the mixture response curves</dd>
      </dl><dl><dt>
          
          <code><a href="make_ggplot_many.html">make_ggplot_many()</a></code> 
        </dt>
        <dd>Makes a ggplot of the mixture response curves</dd>
      </dl><dl><dt>
          
          <code><a href="plot_dummy_mixture.html">plot_dummy_mixture()</a></code> 
        </dt>
        <dd>Wrapper function to plot dummy concentrations</dd>
      </dl><dl><dt>
          
          <code><a href="plot_mix_vs_individuals.html">plot_mix_vs_individuals()</a></code> 
        </dt>
        <dd>Compare individual and Mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="plot_mixture_response.html">plot_mixture_response()</a></code> 
        </dt>
        <dd>Plot the mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="plot_sample_indv.html">plot_sample_indv()</a></code> 
        </dt>
        <dd>Plot individual dose response curves</dd>
      </dl><dl><dt>
          
          <code><a href="plot_scores.html">plot_scores()</a></code> 
        </dt>
        <dd>Create a violin plot given a data frame with scores.  In this context the
plot compares different mixture prediction methods using the different
scoring methods.</dd>
      </dl><dl><dt>
          
          <code><a href="visualize_clusters.html">visualize_clusters()</a></code> 
        </dt>
        <dd>Visualize Feasible Clusters</dd>
      </dl><dl><dt>
          
          <code><a href="visualize_clusters_blocks.html">visualize_clusters_blocks()</a></code> 
        </dt>
        <dd>Visualize Feasible Clusters</dd>
      </dl><dl><dt>
          
          <code><a href="get_mle_curve_fits.html">get_mle_curve_fits()</a></code> 
        </dt>
        <dd>Maximum likelihood dose response curves</dd>
      </dl></div><div class="section level2">
      <h2 id="rgca-mixture-calculators">RGCA Mixture calculators<a class="anchor" aria-label="anchor" href="#rgca-mixture-calculators"></a></h2>
      
      <p class="section-desc"></p><p>Functions that compute mixture responses</p>

      
    </div><div id="" class="section level2">
      
      
      

      <dl><dt>
          
          <code><a href="create_mix_calc.html">create_mix_calc()</a></code> 
        </dt>
        <dd>Get a function that computes the mixture response.</dd>
      </dl><dl><dt>
          
          <code><a href="create_mix_calc_clustered.html">create_mix_calc_clustered()</a></code> 
        </dt>
        <dd>Get a function that computes the mixture response.</dd>
      </dl><dl><dt>
          
          <code><a href="create_mix_calc_from_summary.html">create_mix_calc_from_summary()</a></code> 
        </dt>
        <dd>These functions are wrappers for the factory method mix_function_generator.
The wrappers provide different ways of sampling the parameters.
Get a function that computes mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="create_mix_calc_sample_row.html">create_mix_calc_sample_row()</a></code> 
        </dt>
        <dd>Get a function that computes the mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="hill_function.html">hill_function()</a></code> 
        </dt>
        <dd>Hill function</dd>
      </dl><dl><dt>
          
          <code><a href="hill_invs_factry.html">hill_invs_factry()</a></code> 
        </dt>
        <dd>The inverse function is used with a single dose response curve, which is
assumed to be a Hill function.  A factory method is used to avoid repeatedly
passing in the curve parameters; once generated, the inverse calculator only
needs a response point y to return an inverse (dose) required to get that
response.</dd>
      </dl><dl><dt>
          
          <code><a href="adjust_concentrations.html">adjust_concentrations()</a></code> 
        </dt>
        <dd>Given input concentrations, suppose some chemicals "deactivate" other
chemicals if they have a higher weight (eg molecular weight, docking score,
or affinity).  This function will adjust the true concentrations to reflect
how the higher weight chemicals will substitute the lower weight chemicals.
If the highest weight chemical has high enough concentration, it can dominate
and result in a mixture with only one effective chemical.  We can set rules
for which chemicals can substitute others using a matrix A_full.</dd>
      </dl><dl><dt>
          
          <code><a href="eff_response_opt.html">eff_response_opt()</a></code> 
        </dt>
        <dd>A factory function that returns a function with one input that can be
optimized with respect to that input. The returned function computes the
generalized concentration addition formula for the input set of chemicals and
input concentrations.</dd>
      </dl><dl><dt>
          
          <code><a href="plot_mixture_response.html">plot_mixture_response()</a></code> 
        </dt>
        <dd>Plot the mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="predict_mix_response.html">predict_mix_response()</a></code> 
        </dt>
        <dd>Predict the mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="predict_mix_response_many.html">predict_mix_response_many()</a></code> 
        </dt>
        <dd>Predict the mixture response</dd>
      </dl><dl><dt>
          
          <code><a href="mix_function_generator.html">mix_function_generator()</a></code> 
        </dt>
        <dd>Factory method to return a function that predicts the mixture response given
the concentrations of the mixture component chemicals. A factory method is
used because the uncertainty quantification is based on a bootstrapped
collection of feasible parameters, and each set of parameters leads to a
different predictor for the mixture effect.  Rather than keeping track of
lists of parameters, we immediately convert the sampled parameter set to a
function (a "calculator") that takes the mixture concentration as input. The
list of calculators can be applied to a</dd>
      </dl></div><div class="section level2">
      <h2 id="rgca-simulation-functions">RGCA Simulation functions<a class="anchor" aria-label="anchor" href="#rgca-simulation-functions"></a></h2>
      
      <p class="section-desc"></p><p>Functions related to the simulation study of the manuscript</p>

      
    </div><div id="" class="section level2">
      
      
      

      <dl><dt>
          
          <code><a href="generate_data.html">generate_data</a></code> 
        </dt>
        <dd>y = (theta1 + u)/(1 + (theta2/x)^phi_c) + v + epsilon
epsilon ~ N(0, sigma^2)
theta1 ~ N(0, 1000)
theta2 ~ Gamma(1e-3, 1e-3)
phi_c ~ Gamma(0.3, 0.3)
u ~ N(0, sigma_u^2)
v ~ N(0, sigma_v^2)
sigma^2 ~ InvGamma(0.1, 0.1) # indexed for each chemical, not global!
sigma_u^2 ~ InvGamma(0.1, 0.1)
sigma_v^2 ~ InvGamma(0.1, 0.1)</dd>
      </dl><dl><dt>
          
          <code><a href="generate_mixture_subset.html">generate_mixture_subset()</a></code> 
        </dt>
        <dd>Generate a string based on the vector of mixture indices that
satisfy the boolean input conditions</dd>
      </dl></div><div class="section level2">
      <h2 id="rgca-miscellaneous-functions">RGCA Miscellaneous functions<a class="anchor" aria-label="anchor" href="#rgca-miscellaneous-functions"></a></h2>
      
      <p class="section-desc"></p><p>Other helpful functions</p>

      
    </div><div id="" class="section level2">
      
      
      

      <dl><dt>
          
          <code><a href="build_replicate_matrix.html">build_replicate_matrix()</a></code> 
        </dt>
        <dd>Builds a design matrix for replicates of dose response data for performing a
simultaneous Gibbs update for the sill, sill random effect, and intercept
random effect</dd>
      </dl><dl><dt>
          
          <code><a href="cluster_centers.html">cluster_centers()</a></code> 
        </dt>
        <dd>Get the cluster results</dd>
      </dl><dl><dt>
          
          <code><a href="compute_mixpred_scores.html">compute_mixpred_scores()</a></code> 
        </dt>
        <dd>Score the predictions</dd>
      </dl><dl><dt>
          
          <code><a href="convert_DP_pack_obj.html">convert_DP_pack_obj()</a></code> 
        </dt>
        <dd>Convert output from dirichletprocess package</dd>
      </dl><dl><dt>
          
          <code><a href="read_prepared_Tox21_data.html">read_prepared_Tox21_data()</a></code> 
        </dt>
        <dd>Read preprocessed Tox21 Input data</dd>
      </dl></div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daniel Zilber, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

